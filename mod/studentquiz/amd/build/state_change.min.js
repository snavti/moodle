define(["jquery","core/ajax","core/notification"],function(a,b,c){var d={SELECTOR:{STATE_SELECT:"#menustatetype",CHANGE_STATE_BUTTON:"div.singlebutton.continue_state_change [type=submit]",STATE_VALUE_INPUT:"input[name=state]",SUBMIT_STATE_BUTTON:"#change_state",CHANGE_STATE_NOTIFICATION:"span.change-question-state"},init:function(){var e=a(d.SELECTOR.STATE_SELECT),f=a(d.SELECTOR.CHANGE_STATE_BUTTON),g=a(d.SELECTOR.STATE_VALUE_INPUT),h=a(d.SELECTOR.SUBMIT_STATE_BUTTON),i=e.val();e.on("change",function(){""!==e.val()&&e.val()!==i?(g.val(e.val()),f.removeAttr("disabled"),h.removeAttr("disabled")):(f.attr("disabled","disabled"),h.attr("disabled","disabled"))}),h.on("click",function(){h.attr("disabled","disabled");var f=d.addPendingJSPromise("studentquizStateChange");require(["core/loadingicon"],function(b){var c=a(d.SELECTOR.CHANGE_STATE_NOTIFICATION);b.addIconToContainerRemoveOnCompletion(c,f)});var g,j={courseid:h.attr("data-courseid"),cmid:h.attr("data-cmid"),questionid:h.attr("data-questionid"),state:e.val()},k=b.call([{methodname:"mod_studentquiz_set_state",args:j}],!0,!0);k[0].then(function(a){c.alert(a.status,a.message),f.resolve(),i=e.val(),window.opener.location.reload()}).fail(g)})},addPendingJSPromise:function(b){M.util.js_pending(b);var d=a.Deferred();return d.then(function(){return M.util.js_complete(b),arguments[0]})["catch"](c.exception),d}};return d});