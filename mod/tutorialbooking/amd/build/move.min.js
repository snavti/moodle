define ("mod_tutorialbooking/move",["jquery","core/log","core/notification","core/ajax","core/sortable_list","core/str","core/templates"],function(a,b,c,d,e,f,g){var h={DRAGGABLE:".tutorial_session",DRAGAREA:".tutorial_sessions",HANDLEELEMENT:".tutorial_session .sectionname",MOVEDOWNCONTROL:".tutorial_session .controls .movedown",MOVEUPCONTROL:".tutorial_session .controls .moveup"},i,j=function(b){return a.Deferred().resolve(b.attr("data-name"))},k=function(){var b=[];a(h.HANDLEELEMENT).each(function(d,e){var h=f.get_string("moveslot","mod_tutorialbooking",e.innerText).then(function(a){return g.render("core/drag_handle",{movetitle:a})}).then(function(b){a(e).prepend(a(b))}).fail(c.exception);b.push(h)});return a.when.apply(a,b)},l=function(a,c){b.debug("Drag started","mod_tutorialbooking/move");i=c.sourceList.children()},m=function(f,e){b.debug("Dropped element","mod_tutorialbooking/move");var g=e.targetList.children().index(e.element),j=a(f.target).closest(h.DRAGAREA),k=e.element.attr("id"),l=a(i.get(g)).attr("id"),m={methodname:"mod_tutorialbooking_moveslot",args:{tutorial:n(j),slot:o(k),target:o(l)}},p=d.call([m]);p[0].done(function(a){if(a.success){if("before"===a.where){b.debug("Slot "+k+" moved before slot "+l,"mod_tutorialbooking/dragdrop")}else{b.debug("Slot "+k+" moved after slot "+l,"mod_tutorialbooking/dragdrop")}}}).fail(c.exception)},n=function(b){return a(b).attr("id").substr(9)},o=function(a){return a.substr(5)};return{init:function init(){b.debug("Setting up","mod_tutorialbooking/dragdrop");a(h.MOVEUPCONTROL).remove();a(h.MOVEDOWNCONTROL).remove();k();var c=new e(h.DRAGAREA);c.getElementName=j;a(h.DRAGAREA+" "+h.DRAGGABLE).on(e.EVENTS.DRAGSTART,l).on(e.EVENTS.DROP,m);b.debug("Setup completed","mod_tutorialbooking/dragdrop")}}});
//# sourceMappingURL=move.min.js.map
